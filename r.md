## Настройка окружения
### Файлы инициализации сессии R
[Efficient R Programming. R Startup](https://bookdown.org/csgillespie/efficientR/set-up.html#r-startup)\
При каждом запуске сесии используются два файла:
* `.Renviron` : определяет переменные окружения, позволяющие R находить внешние программы, а также определяют специфчную для пользователя информацию, напр., API ключи.
* `.Rprofile` : содержит выполняемые при запуске сессии строки R кода, напр., проверяет актуальность версий установленных пакетов. 

Эти файлы могут находиться в одной из трех директорий:
* `R_HOME` -- директория, в которую установлен R. Ее подкаталог `etc` может содержать файлы инициализации. Чтобы посмотреть, где на ПК находится директория `R_HOME` достаточно выполнить в консоли команду `R.home()`.
* `HOME` -- домашняя директория пользователя. Чтобы посмотреть путь к домашней директории достаточно выполнить команду `Sys.getenv("HOME")`.
* Текущая директория R, возвращаемая функцией `getwd()`.

Если файлы инициализации находятся в каждом из этих каталогов, то используется только один из них, по приоритету, обратному указанному выше (т.е. файлы из директории проекта имеют высший приоритет, тогда как файлы из каталога установки R используются только в случае, если файлы инициализации не найдены в других местах). Следующие команды позволяют открыть файлы иницилизации во встроенном редакторе (для унификации синтаксиса пути к файлу для разных операционных систем рекомендуется использовать функцию `file.path()`):
```r
user_renviron = path.expand(file.path("~", ".Renviron"))   ; .Rprofile in usr HOME folder
file.edit(user_renviron)
file.edit(".Rprofile")                                     ; edit current project specific .Rprofile
```
#### .Rprofile
* Чтобы изменить поведение R-сессии в зависимости от того, запущени ли она в терминале или нет, используется конструкция `if(interactive()) {...}`.\
* Если в файле профиля есть функция `.Last()`, то она всегда выполняется при закрытии сессии.\
* В файле профиля удобно определить короткие алиасы для часто используемых функций: `v = utils::View`.
* Объекты, имена которых начинаются с точки, являются скрытыми и не отображаются в панели *Environment* и функцией `ls()`, поэтому используем это в файле .Rprofile:
```r
.env = new.env()
.env$ht = function(df, n = 6) rbind(head(df, n), tail(df, n))  ; добавляем функцию в окружение .env
  ...
attach(.env)          ; в конце файла .Rprofile присоединяем созданные объекты к текущему окружению
```
#### .Renviron
Значения переменных окружения могут быть получены или изменены с помощью функций:
```r
Sys.getenv("R_LIBS_USER")           ; выводит значение указанной переменной окружения
Sys.getenv()                        ; выводит значения всех переменных окружения
Sys.setenv("TEST" = "test-string")  ; устанавливает значение переменной окружения для текущей сессии
Sys.unsetenv("TEST")                ; деинициализирует переменную окружения
```
В файле *.Renviron* значения переменных окружения указываются явно. Кроме значений переменных окружения здесь также обычно сохранятются значения API-ключей, которые должны быть доступны в каждой сессии.
```ini
TMPDIR = /data/R_tmp/                                        ; определить каталог для временных файлов
R_COMPILE_PKGS = 3                                           ; byte compile all packages
R_LIBS_SITE = /usr/lib/R/site-library:/usr/lib/R/library     ; explicitly state where to look for packages
R_DEFAULT_PACKAGES = utils,grDevices,graphics,stats,methods  ;  явно указываем пакеты для загрузки (I don’t load the datasets package, but I ensure that methods is always loaded)
ZEIT_KEY=PUT_YOUR_KEY_HERE
```
Значение созданной переменной может быть получено функцией `Sys.getenv("ZEIT_KEY")`.

### Настройка IDE
Различные аспекты поведения RStudio и плагинов устанавливаются через опции, указанные в файле профиля:
```r
getOprion("warn")           ; получить текущее значение опции "warn"
options(warn = -1)          ; отколючить предупреждения (по умолчанию = 0)
options()                   ; вывести список всех опций (их > 120)

```
Одной командой `options()` можно установить значения нескольких опций, указав их через запятую.

##  Замечания по пакетам R
* Пакет может содержать примеры использования, которые можно вывести командой `example(package_name)` в консоли.
* Некоторые пакеты R содержат дополнительные справочные материалы, список которых можно вывести командой вида `vignette(package = "data.table")`.\
Чтобы посмотреть конкретную виньетку пакета, нужно выполнить `vignette("datatable-sd-usage", package = "data.table")`.

## Общие замечания по стилистике
* код разделяется на блоки, размещенным на одной строке комментарием вида `# Load data ----`
* `&` и `|` никогда не следует использовать внутри предложения `if`, потому что они могут возвращать векторы.  
Вместо этого всегда используйте `&&` и `||`.
 
## References
* [TOP 100 R TUTORIALS : STEP BY STEP GUIDE](https://www.listendata.com/p/r-programming-tutorials.html)
* [List of R Commands & Functions](https://statisticsglobe.com/r-functions-list/)

# Модули (слои) для построения нейронных сетей
Слои нейронной сети именуются *модулями*. В torch имеется большое разнообразие встроенных модулей (`nn_module`).

## Линейный слой
Введем обозначения:
* `n_in` – число входов для каждого нейрона слоя (равно числу входных переменных)
* `n_out` – число выходов слоя (равно числу нейронов в слое)
```r
l <- nn_linear(in_features = n_in, out_features = n_out)   ; линейный слой из n_out нейронов с чилом входов n_in

```
Каждый слой `layer` имеет свойсва:
* `layer@wight` – тензор, число строк в котором равно `n_out`, а число столбцов - `n_in`)
* `layer@bias` – тензор из одного столбца с количеством строк, равными `n_out`.
По соображениям производительности линейный модуль хранит тензоры веса и смещения в транспонированной форме.  
В модулях тензоры весов и смещений автоматический создаются с параметром `requires_grad = TRUE`.

Чтобы применить модуль к входным данным, нужно просто вызвать его как функцию от входных данных:
```r
output <- layer(x)
```

## Другие виды модулей
```r
nn_conv1d()     ; одномерный сверточный слой
nn_conv2d()     ; двухмерный сверточный слой
nn_conv3d()     ; трехмерный сверточный слой
nn_lstm()       ; рекуррентный слой
nn_gru()        ; рекуррентный слой
nn_embedding()  ; используется для встраивания категориальных данных в многомерное пространство
```


## Тензоры
#### Создание тензора
```r
t1 <- torch_tensor(1)                              ; тензор-скаляр
t1 <- torch_tensor(matrix(1:9, ncol = 3))          ; двумерный тензор, созданный из матрицы
t1 <- torch_tensor(array(1:24, dim = c(4, 3, 2)))  ; многомерный тензор
t1 <- torch_zeros(2, 5)                            ; двумерный тензор с нулевыми значениями
t1 <- torch_ones(2, 2)                             ; тензор из единиц
t1 <- torch_eye(n = 5)                             ; нулевой тензор с единицами на главной диагонали
t1 <- torch_diag(c(1, 2, 3))                       ; нулевой тензор с указанными значениями на главной диагонали
t1 <- torch_randn(3, 3)                            ; тензор 3x3 со случайными значениями

t1 <- torch_tensor(1:5, dtype = torch_float())     ; тензор с вещественными значениями
t1 <- torch_tensor(1:5, device = "cuda")           ; тензор на указанном устройстве
```
В качестве значений столбцов тензор может принимать упорядоченные факторы, напр., factor(c("a", "b", "c"), ordered = TRUE).
Неупорядоченные символьные факторные переменные должны быть предварительно преобразованиы к числовому виду функцией `as.numeric()`.

Значения `NA` при создании тензора преобразуются в `NaN` и должны быть заменены числовыми идентификаторами перед применением в нейронных сетях.

Для одномерных тензоров не различаются тензоры строк или тензоры столбцов, поэтому операции с ними не требуют транспонирования

#### Свойства тензоров:
* $dtype – тип тензора
* $device – где расположен тензор (cpu|gpu)
* $shape – размерность тензора

Ряд свойств тензора можно изменить функцией to():
```r
t2 <- t1$to(dtype = torch_int())
t2 <- t1$to(device = "cuda")                       ; только, если поддерживается cuda
```

#### Операции над тензорами
Над тензорами доступны все обычные арифметические операции. При этом для результата создается новый объект, а операнды арифметической операции не изменяются.
```r
torch_add(t1, t2)         ; сложение тензоров
t1$add(t2)                ; эквивалентно функции torch_add()
torch_multiply(t1, t2)    ; попарное перемножение элементов тензоров
torch_matmul(t1, t2)      ; матричное умножение тензоров
t1$matmul(t2)             ; матричное умножение тензоров
t1$dot(t2)                ; матричное умножение тензоров
t1$t()                    ; транспонирование тензора
```
Для inplace-изменения тензора используются аналогичные методы с подчеркиванием в конце названия метода:
```r
t1$add_(t2)               ; inplace-модификация тензора t1 при сложении
```
Часто используемые операции над тензорами:
```r
t1$sum()                  ; сумма всех элементов тензора
t1$sum(dim = 1)           ; суммы по столбцам !! (указывается, какое измерение сворачивается)
t1$sum(dim = 2)           ; суммы по строкам  !! (указывается, какое измерение сворачивается)
t1$sum(dim = c(3, 4))     ; сворачивание тензора по измерениям 3 и 4 путем суммирования
```
Функции `unsqueeze()` и `squeeze()` добавляют или удаляют размерность в указанном расположении:
```r
t1 <- torch_randn(3)      ; dim(t1) = 1
t1$unsqueeze(2)           ; dim(t1) = 2 - размерность тензора стала c(3, 1)
```

## Индексация и слайсинг
```r
t2[1, ]                    ; первый столбец тензора
t2[1, , drop = FALSE]      ; в этом случае сохраняется размерность исходного тенхора (остальншые размерности превращаются в 1)
t2[ , 1:8:2]               ; значения из каждого второго столбца между столбцами 1 и 8
t2[-1, -1]                 ; доступ к последнему элементу в тензоре
t2[1, ..]                  ; будет работать для тенхоров любой размерности
t2 <- t$view(c(2, 12))     ; изменение формы тензора (без изменения его расположения в памяти)
```

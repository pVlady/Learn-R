# Rolling Joins

> Как правило, скользящие соединения используются для таблиц, имеющих столбцы с датами.

Для создания скользящего соединения обе таблицы должны иметь ключ по столбцам, которые участвуют в соединении.

> *При использовании скользящего соединения с таблицей, имеющей  multi-column key, необходимо, чтобы столбец, по которому происходит соединение, был последним столбцом ключа.*

Скользящее соединение двух таблиц по столбцу `RollDate`:

```r
setkey(dt1, "RollDate")
setkey(dt2, "RollDate")
dt1[dt2, roll = TRUE)]
```

Как и при обычном соединении в этом случае в результате будут присутствовать все записи таблицы `dt2`с присоединенными к ним записями таблицы  `dt1`. Даты `dt1$RollDate`  будут скользить вперед до ближайшей даты `dt2$RollDate`, после чего записи соединяются.  В результате каждая запись таблицы `dt2` будет связана с ближайшей предшествующей ей записью таблицы `dt1`. При этом отдельные записи таблицы `dt1`будут дублироваться в результате (одна и та же запись будет соединена с разными записями `dt2`), если в `dt1` будут отсутствовать данные между некоторыми датами таблицы `dt2`, т. к. в этом случае разным записям таблицы `dt2` будет соответствовать одна и та же "проскользнувшая" запись таблицы `dt1`. В итоговом соединении присутствует один столбец `RollDate`, который принимает значения этого столбца из таблицы `dt2`.

Существует возможность изменить направление соединения, т. е. связывать с источником не ближайшую *предшествующую* запись, а ближайшую *следующую*. Для этого при соединении нужно указать `roll = -Inf`.


